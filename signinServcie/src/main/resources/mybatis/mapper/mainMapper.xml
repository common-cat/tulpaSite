<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="wiki.common_cat.signinService.mapper.SignInMapper">
    <update id="addPreUser" >
        insert into pre_users (email,date,salt,pwdhash,tulpas,hosts) values (#{email},NOW(),#{salt},#{pwdhash},#{tulpas},#{hosts})
    </update>
    <select id="getPreUser" resultType="wiki.common_cat.signinService.entities.User">
        select * from pre_users where email=#{email}
    </select>
    <delete id="delPreUser">
        delete from pre_users where email=#{email}
    </delete>
    <insert id="addUser">
        insert into users (date,salt,pwdhash,lastLoginDate,status,loginTimes) values (NOW(),#{salt},#{pwdhash},NOW(),0,0);
    </insert>
    <select id="getID" resultType="int">
        SELECT LAST_INSERT_ID();
    </select>
    <select id="getIDByEmail" resultType="int">
        select id from users where email=#{email}
    </select>
    <insert id="addUserInfo">
        insert into userinfo (id,tulpas,hosts) values (#{id},#{tulpas},#{hosts})
    </insert>
    <insert id="addDoc">
        insert into doc (id,HTML,date) values (#{id},"",NOW())
    </insert>
    <insert id="addImage">
        create table ${imgTable}(imageID int primary key auto_increment,file longblob,date varchar(32),hash int);
    </insert>
</mapper>